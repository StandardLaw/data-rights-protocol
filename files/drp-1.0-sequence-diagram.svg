<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2124px" preserveAspectRatio="none" style="width:1430px;height:2124px;background:#FFFFFF;" version="1.1" viewBox="0 0 1430 2124" width="1430px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="32.0499" id="_title" style="stroke:none;stroke-width:1.0;" width="140" x="641.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="130" x="646.25" y="32.5559">DRP Request Flow</text><rect fill="#FFFFFF" height="792.0382" style="stroke:#181818;stroke-width:1.0;" width="10" x="1107.5" y="1086.8202"/><rect fill="none" height="192.374" style="stroke:#000000;stroke-width:1.5;" width="682" x="174" y="598.5391"/><rect fill="none" height="536.535" style="stroke:#000000;stroke-width:1.5;" width="1190" x="10" y="1262.4653"/><rect fill="none" height="282.232" style="stroke:#000000;stroke-width:1.5;" width="1016" x="174" y="1509.7683"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="129.5118" y2="2038.5745"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="255.5" x2="255.5" y1="129.5118" y2="2038.5745"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="436.5" x2="436.5" y1="129.5118" y2="2038.5745"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="764" x2="764" y1="129.5118" y2="2038.5745"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1112" x2="1112" y1="129.5118" y2="2038.5745"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="125.0318">User</text><ellipse cx="38.5" cy="56.5499" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.5,64.5499 L38.5,91.5499 M25.5,72.5499 L51.5,72.5499 M38.5,91.5499 L25.5,106.5499 M38.5,91.5499 L51.5,106.5499 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="2054.5564">User</text><ellipse cx="38.5" cy="2067.5364" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.5,2075.5364 L38.5,2102.5364 M25.5,2083.5364 L51.5,2083.5364 M38.5,2102.5364 L25.5,2117.5364 M38.5,2102.5364 L51.5,2117.5364 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132" x="189.5" y="93.0499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="196.5" y="117.0318">Authorized Agent</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132" x="189.5" y="2037.5745"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="196.5" y="2061.5564">Authorized Agent</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="383.5" y="93.0499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="390.5" y="117.0318">DRP Network</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="383.5" y="2037.5745"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="390.5" y="2061.5564">DRP Network</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="683" y="93.0499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="690" y="117.0318">Privacy Infrastructure</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163" x="683" y="2037.5745"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="690" y="2061.5564">Privacy Infrastructure</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="1045" y="93.0499"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1052" y="117.0318">Covered Business</text><rect fill="#E2E2F0" height="35.4619" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="1045" y="2037.5745"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1052" y="2061.5564">Covered Business</text><rect fill="#FFFFFF" height="792.0382" style="stroke:#181818;stroke-width:1.0;" width="10" x="1107.5" y="1086.8202"/><path d="M43,144.5118 L43,213.5118 L311,213.5118 L311,154.5118 L301,144.5118 L43,144.5118 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M301,144.5118 L301,154.5118 L311,154.5118 L301,144.5118 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="49" y="165.2808">dashed sequence lines are out of scope</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="49" y="185.2098">of DRP, specific to implementation of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="49" y="205.1389">AA, PIP, resepectively</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1423.5" x="0" y="242.5364"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="242.5364" y2="242.5364"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="245.5364" y2="245.5364"/><rect fill="#EEEEEE" height="28.475" style="stroke:#000000;stroke-width:2.0;" width="410" x="506.75" y="229.2989"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="393" x="512.75" y="249.6009">Background Sync between DRP Directories and Participants</text><path d="M184,272.7739 L184,321.7739 L835,321.7739 L835,282.7739 L825,272.7739 L184,272.7739 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,272.7739 L825,282.7739 L835,282.7739 L825,272.7739 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326" x="237.75" y="293.5429">This has not been added to spec yet. for discussion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="237.75" y="313.4719">see</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="506" x="262.75" y="313.4719">https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10" x="768.75" y="313.4719">Â </text><polygon fill="#181818" points="424.5,369.49,434.5,373.49,424.5,377.49,428.5,373.49" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="255.5" x2="430.5" y1="373.49" y2="373.49"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="262.5" y="347.4009">fetch businesses' API/etc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="262.5" y="367.33">from directory</text><polygon fill="#181818" points="447.5,423.348,437.5,427.348,447.5,431.348,443.5,427.348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="763.5" y1="427.348" y2="427.348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="453.5" y="401.259">fetch agents' signing keys, etc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="453.5" y="421.188">from directory</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1423.5" x="0" y="458.5855"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="458.5855" y2="458.5855"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="461.5855" y2="461.5855"/><rect fill="#EEEEEE" height="28.475" style="stroke:#000000;stroke-width:2.0;" width="231" x="596.25" y="445.348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="214" x="602.25" y="465.65">Onboarding and request creation</text><polygon fill="#181818" points="243.5,525.681,253.5,529.681,243.5,533.681,247.5,529.681" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="38.5" x2="249.5" y1="529.681" y2="529.681"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="45.5" y="503.592">Onboard and verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="45.5" y="523.521">identity attributes once</text><polygon fill="#181818" points="243.5,579.5391,253.5,583.5391,243.5,587.5391,247.5,583.5391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="38.5" x2="249.5" y1="583.5391" y2="583.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="45.5" y="557.4501">Requests data rights action to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="45.5" y="577.3791">specific business</text><path d="M174,598.5391 L242,598.5391 L242,611.0141 L232,621.0141 L174,621.0141 L174,598.5391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="192.374" style="stroke:#000000;stroke-width:1.5;" width="682" x="174" y="598.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="189" y="615.8411">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="257" x="257" y="614.333">["AA has not interacted with this PIP before"]</text><path d="M184,628.339 L184,677.339 L835,677.339 L835,638.339 L825,628.339 L184,628.339 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,628.339 L825,638.339 L835,638.339 L825,628.339 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="362" x="203.75" y="649.108">(This sequence/endpoint has not been added to spec yet,</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="506" x="203.75" y="669.037">https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="713.75" y="669.037">for discussion)</text><polygon fill="#181818" points="752.5,725.055,762.5,729.055,752.5,733.055,756.5,729.055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="255.5" x2="758.5" y1="729.055" y2="729.055"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="262.5" y="702.966">fetch API token w/ signed request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="262.5" y="722.895">if this relationship is new</text><polygon fill="#181818" points="266.5,778.9131,256.5,782.9131,266.5,786.9131,262.5,782.9131" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="782.9131" y2="782.9131"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="445" x="272.5" y="756.8241">Provide an API token which can be used to authenticate GET requests,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="272.5" y="776.7531">provide rate limiting on agent by agent basis, etc</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1423.5" x="0" y="821.1506"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="821.1506" y2="821.1506"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1423.5" y1="824.1506" y2="824.1506"/><rect fill="#EEEEEE" height="28.475" style="stroke:#000000;stroke-width:2.0;" width="173" x="625.25" y="807.9131"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="156" x="631.25" y="828.2151">Request State Machine</text><polygon fill="#181818" points="752.5,868.3171,762.5,872.3171,752.5,876.3171,756.5,872.3171" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="255.5" x2="758.5" y1="872.3171" y2="872.3171"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="389" x="262.5" y="866.1571">construct a Data Rights Request and submits to API backend</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#202-post-exercisekidaa-id-data-rights-exercise-endpoint" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#202-post-exercisekidaa-id-data-rights-exercise-endpoint" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#202-post-exercisekidaa-id-data-rights-exercise-endpoint" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#202-post-exercisekidaa-id-data-rights-exercise-endpoint" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="92" x="655.5" y="866.1571">POST /exercise</text></a><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="764.5" x2="806.5" y1="926.1751" y2="926.1751"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="806.5" x2="806.5" y1="926.1751" y2="939.1751"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="765.5" x2="806.5" y1="939.1751" y2="939.1751"/><polygon fill="#181818" points="775.5,935.1751,765.5,939.1751,775.5,943.1751,771.5,939.1751" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="771.5" y="900.0861">Verify signature of request, etc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="771.5" y="920.0151">persist request</text><polygon fill="#181818" points="266.5,969.1042,256.5,973.1042,266.5,977.1042,262.5,973.1042" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="973.1042" y2="973.1042"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="272.5" y="966.9442">return request ID</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="110" x="383.5" y="966.9442">response schema</text></a><path d="M184,986.1042 L184,1035.1042 L835,1035.1042 L835,996.1042 L825,986.1042 L184,986.1042 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,986.1042 L825,996.1042 L835,996.1042 L825,986.1042 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="311.75" y="1006.8732">[POST /exercise response,</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#203-get-status-data-rights-status-endpoint" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#203-get-status-data-rights-status-endpoint" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#203-get-status-data-rights-status-endpoint" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#203-get-status-data-rights-status-endpoint" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="74" x="476.75" y="1006.8732">GET /status</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="550.75" y="1006.8732">,</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-204-post-status_callback-data-rights-status-callback-endpoint" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-204-post-status_callback-data-rights-status-callback-endpoint" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-204-post-status_callback-data-rights-status-callback-endpoint" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-204-post-status_callback-data-rights-status-callback-endpoint" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="135" x="558.75" y="1006.8732">POST status_callback</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="693.75" y="1006.8732">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="311.75" y="1026.8022">request state: OPEN</text><polygon fill="#181818" points="1095.5,1082.8202,1105.5,1086.8202,1095.5,1090.8202,1099.5,1086.8202" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="764.5" x2="1101.5" y1="1086.8202" y2="1086.8202"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="771.5" y="1060.7312">process is out of scope for protocol,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="771.5" y="1080.6602">suggest integrating directly to existing DSR tooling</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1117.5" x2="1159.5" y1="1160.6073" y2="1160.6073"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1159.5" x2="1159.5" y1="1160.6073" y2="1173.6073"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1118.5" x2="1159.5" y1="1173.6073" y2="1173.6073"/><polygon fill="#181818" points="1128.5,1169.6073,1118.5,1173.6073,1128.5,1177.6073,1124.5,1173.6073" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="1124.5" y="1114.5893">process request through normal DSR process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="1124.5" y="1134.5183">verify identity, collect records, process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="1124.5" y="1154.4473">request using PIP tooling</text><polygon fill="#181818" points="266.5,1203.5363,256.5,1207.5363,266.5,1211.5363,262.5,1207.5363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="1207.5363" y2="1207.5363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="272.5" y="1201.3763">Inform Agent request is acknowledged</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="49" x="521.5" y="1201.3763">schema</text></a><path d="M184,1220.5363 L184,1249.5363 L835,1249.5363 L835,1230.5363 L825,1220.5363 L184,1220.5363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,1220.5363 L825,1230.5363 L835,1230.5363 L825,1220.5363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="416.25" y="1241.3053">request state: IN PROGRESS</text><path d="M10,1262.4653 L78,1262.4653 L78,1274.9403 L68,1284.9403 L10,1284.9403 L10,1262.4653 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="536.535" style="stroke:#000000;stroke-width:1.5;" width="1190" x="10" y="1262.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="25" y="1279.7673">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="209" x="93" y="1278.2592">["optional additional verification flow</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#3021-need_user_verification-state-flow-semantics" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#3021-need_user_verification-state-flow-semantics" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#3021-need_user_verification-state-flow-semantics" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#3021-need_user_verification-state-flow-semantics" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="66" x="305" y="1278.2592">(DRP 3.02.1)</text></a><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="9" x="371" y="1278.2592">"]</text><polygon fill="#181818" points="775.5,1329.1233,765.5,1333.1233,775.5,1337.1233,771.5,1333.1233" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769.5" x2="1106.5" y1="1333.1233" y2="1333.1233"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="781.5" y="1307.0342">need additional verification of consumer identity</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="781.5" y="1326.9632">direct user to visit a specific URL.</text><polygon fill="#181818" points="266.5,1363.0523,256.5,1367.0523,266.5,1371.0523,262.5,1367.0523" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="1367.0523" y2="1367.0523"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="272.5" y="1360.8923">Update request state to need_user_verification</text><path d="M184,1380.0523 L184,1429.0523 L835,1429.0523 L835,1390.0523 L825,1380.0523 L184,1380.0523 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,1380.0523 L825,1390.0523 L835,1390.0523 L825,1380.0523 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="416.25" y="1400.8213">request state: IN PROGRESS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="416.25" y="1420.7503">needs_user_verification</text><polygon fill="#181818" points="49.5,1456.8393,39.5,1460.8393,49.5,1464.8393,45.5,1460.8393" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="254.5" y1="1460.8393" y2="1460.8393"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="55.5" y="1454.6793">Notify user of requirement</text><polygon fill="#181818" points="1095.5,1490.7683,1105.5,1494.7683,1095.5,1498.7683,1099.5,1494.7683" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="1101.5" y1="1494.7683" y2="1494.7683"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399" x="45.5" y="1488.6083">User visits URL in browser or webview and provides verification</text><path d="M174,1509.7683 L237,1509.7683 L237,1522.2434 L227,1532.2434 L174,1532.2434 L174,1509.7683 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="282.232" style="stroke:#000000;stroke-width:1.5;" width="1016" x="174" y="1509.7683"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="189" y="1527.0704">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="252" y="1525.5622">["identity verification successful?"]</text><polygon fill="#181818" points="775.5,1556.4972,765.5,1560.4972,775.5,1564.4972,771.5,1560.4972" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769.5" x2="1106.5" y1="1560.4972" y2="1560.4972"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="781.5" y="1554.3372">verification complete</text><polygon fill="#181818" points="266.5,1590.4263,256.5,1594.4263,266.5,1598.4263,262.5,1594.4263" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="1594.4263" y2="1594.4263"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="272.5" y="1588.2663">move request forward in state machine</text><path d="M184,1607.4263 L184,1636.4263 L835,1636.4263 L835,1617.4263 L825,1607.4263 L184,1607.4263 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,1607.4263 L825,1617.4263 L835,1617.4263 L825,1607.4263 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="416.25" y="1628.1953">request state: IN PROGRESS</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="174" x2="1190" y1="1643.3553" y2="1643.3553"/><polygon fill="#181818" points="775.5,1666.2843,765.5,1670.2843,775.5,1674.2843,771.5,1670.2843" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769.5" x2="1106.5" y1="1670.2843" y2="1670.2843"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="781.5" y="1664.1243">Signal to close request</text><line style="stroke:#181818;stroke-width:2.0;" x1="262.5" x2="272.5" y1="1699.2133" y2="1709.2133"/><line style="stroke:#181818;stroke-width:2.0;" x1="262.5" x2="272.5" y1="1709.2133" y2="1699.2133"/><line style="stroke:#181818;stroke-width:1.0;" x1="267.5" x2="763.5" y1="1704.2133" y2="1704.2133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="272.5" y="1698.0533">Signal to close request</text><path d="M184,1717.2133 L184,1786.2133 L835,1786.2133 L835,1727.2133 L825,1717.2133 L184,1717.2133 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,1717.2133 L825,1727.2133 L835,1727.2133 L825,1717.2133 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="323.75" y="1737.9823">request state: DENIED</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="323.75" y="1757.9114">request sequence terminates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="323.75" y="1777.8404">a request can be denied for a number of</text><a href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#302-request-statuses" target="_top" title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#302-request-statuses" xlink:actuate="onRequest" xlink:href="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#302-request-statuses" xlink:show="new" xlink:title="https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#302-request-statuses" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="107" x="579.75" y="1777.8404">different reasons</text></a><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1117.5" x2="1159.5" y1="1831.9294" y2="1831.9294"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1159.5" x2="1159.5" y1="1831.9294" y2="1844.9294"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1118.5" x2="1159.5" y1="1844.9294" y2="1844.9294"/><polygon fill="#181818" points="1128.5,1840.9294,1118.5,1844.9294,1128.5,1848.9294,1124.5,1844.9294" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="1124.5" y="1825.7694">Process Request....</text><polygon fill="#181818" points="775.5,1874.8584,765.5,1878.8584,775.5,1882.8584,771.5,1878.8584" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="769.5" x2="1111.5" y1="1878.8584" y2="1878.8584"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="781.5" y="1872.6984">Processing is completed</text><polygon fill="#181818" points="266.5,1908.7874,256.5,1912.7874,266.5,1916.7874,262.5,1912.7874" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="260.5" x2="763.5" y1="1912.7874" y2="1912.7874"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="324" x="272.5" y="1906.6274">update request state, callback to Authorized Agent</text><path d="M184,1925.7874 L184,1954.7874 L835,1954.7874 L835,1935.7874 L825,1925.7874 L184,1925.7874 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M825,1925.7874 L825,1935.7874 L835,1935.7874 L825,1925.7874 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="426.75" y="1946.5564">request state: FULFILLED</text><polygon fill="#181818" points="49.5,1982.6455,39.5,1986.6455,49.5,1990.6455,45.5,1986.6455" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="254.5" y1="1986.6455" y2="1986.6455"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="55.5" y="1980.4855">Notify user of completion</text><polygon fill="#181818" points="1100.5,2016.5745,1110.5,2020.5745,1100.5,2024.5745,1104.5,2020.5745" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="1106.5" y1="2020.5745" y2="2020.5745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="462" x="45.5" y="2014.4145">User may have results URL to download or view in browser or user agent</text><!--MD5=[d621af7925391ba0ebf97a23035367ee]
@startuml
title DRP Request Flow

Actor User
participant "Authorized Agent" 
participant "DRP Network"
participant "Privacy Infrastructure" 
participant "Covered Business"

note right of User
        dashed sequence lines are out of scope
        of DRP, specific to implementation of
        AA, PIP, resepectively
end note


== Background Sync between DRP Directories and Participants ==
note over "Privacy Infrastructure", "Authorized Agent"
        This has not been added to spec yet. for discussion
        see [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/60]] 
end note
"Authorized Agent" -> "DRP Network": fetch businesses' API/etc\nfrom directory
"Privacy Infrastructure" -> "DRP Network": fetch agents' signing keys, etc\nfrom directory

== Onboarding and request creation ==

User - -> "Authorized Agent": Onboard and verify\nidentity attributes once
User - -> "Authorized Agent": Requests data rights action to\nspecific business

opt "AA has not interacted with this PIP before"
        note over "Privacy Infrastructure", "Authorized Agent"
                (This sequence/endpoint has not been added to spec yet,
                [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/issues/58]] for discussion)
        end note
        "Authorized Agent" -> "Privacy Infrastructure": fetch API token w/ signed request\nif this relationship is new
        "Privacy Infrastructure" -> "Authorized Agent": Provide an API token which can be used to authenticate GET requests,\nprovide rate limiting on agent by agent basis, etc
end

== Request State Machine ==

"Authorized Agent" -> "Privacy Infrastructure": construct a Data Rights Request and submits to API backend [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#202-post-exercisekidaa-id-data-rights-exercise-endpoint POST /exercise]]

"Privacy Infrastructure" - -> "Privacy Infrastructure": Verify signature of request, etc\npersist request
"Privacy Infrastructure" -> "Authorized Agent": return request ID [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request response schema]]
note over "Privacy Infrastructure", "Authorized Agent" 
        [POST /exercise response, [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#203-get-status-data-rights-status-endpoint GET /status]], [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-204-post-status_callback-data-rights-status-callback-endpoint POST status_callback]]]
        request state: OPEN
end note

"Privacy Infrastructure" - -> "Covered Business": process is out of scope for protocol,\nsuggest integrating directly to existing DSR tooling
activate "Covered Business"
        "Covered Business" - -> "Covered Business": process request through normal DSR process\nverify identity, collect records, process\nrequest using PIP tooling
        "Privacy Infrastructure" -> "Authorized Agent": Inform Agent request is acknowledged [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#user-content-303-schema-status-of-a-data-subject-exercise-request schema]]
        note over "Privacy Infrastructure", "Authorized Agent" 
                request state: IN PROGRESS
        end note

        opt "optional additional verification flow [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#3021-need_user_verification-state-flow-semantics (DRP 3.02.1)]]"
                "Covered Business" - -> "Privacy Infrastructure": need additional verification of consumer identity\ndirect user to visit a specific URL.
                "Privacy Infrastructure" -> "Authorized Agent": Update request state to need_user_verification
                note over "Privacy Infrastructure", "Authorized Agent" 
                        request state: IN PROGRESS
                        needs_user_verification
                end note
                
                "Authorized Agent" - -> User: Notify user of requirement
                User -> "Covered Business": User visits URL in browser or webview and provides verification
                alt "identity verification successful?"
                        "Covered Business" - -> "Privacy Infrastructure": verification complete
                        "Privacy Infrastructure" -> "Authorized Agent": move request forward in state machine
                        note over "Privacy Infrastructure", "Authorized Agent" 
                                request state: IN PROGRESS
                        end note
                else
                        "Covered Business" - -> "Privacy Infrastructure": Signal to close request
                        "Privacy Infrastructure" ->x "Authorized Agent": Signal to close request
                        note over "Privacy Infrastructure", "Authorized Agent" 
                                request state: DENIED
                                request sequence terminates
                                a request can be denied for a number of [[https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/0863d03717082599e19930ea6f009c048b86e979/data-rights-protocol.md#302-request-statuses different reasons]]
                        end note
                end
        end

        "Covered Business" - -> "Covered Business": Process Request....
        "Covered Business" - -> "Privacy Infrastructure": Processing is completed
deactivate "Covered Business"
"Privacy Infrastructure" -> "Authorized Agent": update request state, callback to Authorized Agent
note over "Privacy Infrastructure", "Authorized Agent" 
        request state: FULFILLED
end note

"Authorized Agent" - -> User: Notify user of completion
User -> "Covered Business": User may have results URL to download or view in browser or user agent
@enduml

PlantUML version 1.2022.12(Sun Oct 23 11:12:26 PDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>